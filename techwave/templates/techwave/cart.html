{% extends "base.html" %}
{% load static %}

{% block content %}

<head>
   <link rel="stylesheet" href="{% static 'css/cartstyle.css' %}">
</head>

<section class="cart">
    <div class="container">
        <ul class="cart-items" id="cart-items">
            <!-- Produkty zostaną wyświetlone tutaj -->
        </ul>
        <div class="cart-buttons">
            <button class="checkout-button">Przejdź do kasy</button>
            <button class="continue-shopping-button">Kontynuuj zakupy</button>
        </div>
    </div>
</section>


<script>
    var cart = JSON.parse(localStorage.getItem('cart')) || [];
    var cartItemsElement = document.getElementById('cart-items');
    
    // Funkcja usuwająca produkt z koszyka i odświeżająca wyświetlanie
    function removeFromCart(index) {
        cart.splice(index, 1);
        localStorage.setItem('cart', JSON.stringify(cart));
        displayCart();
    }
    
    // Funkcja wyświetlająca produkty w koszyku
    function displayCart() {
        cartItemsElement.innerHTML = ''; // Wyczyść zawartość przed aktualizacją
    
        cart.forEach(function(product, index) {
            var li = document.createElement('li');
            li.classList.add('cart-item');
    
            // Tworzenie elementu obrazu
            var img = document.createElement('img');
            img.src = product.image;
            img.alt = product.name;
            img.classList.add('product-image'); // Dodaj klasę do obrazka
    
            // Tworzenie elementów nazwy, ceny i przycisku usuwania
            var detailsDiv = document.createElement('div');
            detailsDiv.classList.add('product-details');
    
            var name = document.createElement('span');
            name.textContent = product.name;
            name.classList.add('product-name'); // Dodaj klasę do nazwy
    
            var price = document.createElement('span');
            price.textContent = product.price;
            price.classList.add('product-price'); // Dodaj klasę do ceny
    
            var removeButton = document.createElement('button');
            removeButton.textContent = 'Remove';
            removeButton.classList.add('remove-button'); // Dodaj klasę do przycisku usuwania
            removeButton.onclick = function() {
                removeFromCart(index);
            };
    
            // Dodanie wszystkich elementów do elementu <li>
            detailsDiv.appendChild(name);
            detailsDiv.appendChild(price);
            li.appendChild(img);
            li.appendChild(detailsDiv);
            li.appendChild(removeButton);
    
            // Dodanie <li> do listy
            cartItemsElement.appendChild(li);
        });
    }
    
    // Wyświetl produkty w koszyku po załadowaniu strony
    displayCart();
    
    // Pobierz przyciski
    var checkoutButton = document.querySelector('.checkout-button');
    var continueShoppingButton = document.querySelector('.continue-shopping-button');
    
    // Przycisk "Przejdź do kasy"
    checkoutButton.onclick = function() {
        // Przekieruj do strony kasy
        window.location.href = '/payment';
    };
    
    // Przycisk "Kontynuuj zakupy"
    continueShoppingButton.onclick = function() {
        // Przekieruj do strony głównej
        window.location.href = '/productsite';
    };

</script>

{% endblock %}
